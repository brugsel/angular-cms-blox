"use strict";angular.module("angularCmsBlox",["ngResource","ngCookies","satellizer","pascalprecht.translate","xeditable"]),angular.module("angularCmsBlox").run(["$templateCache",function(a){a.put("auth/login.template.html",'<div class="container">\n  <button ng-hide="ctrl.isAuthenticated()" ng-click="ctrl.authenticate(\'google\')">Sign in with Google</button>\n  <button ng-show="ctrl.isAuthenticated()" ng-click="ctrl.logout()">Logout</button>\n</div>\n'),a.put("cms/cms-text.template.html",'<span translate-cloak editable-text="text" onaftersave="ctrl.save()" e-form="textBtnForm">\n  {{text}} <i class="fa fa-edit" ng-if="ctrl.isAuthenticated()" class="btn btn-sm" ng-click="textBtnForm.$show()" ng-hide="textBtnForm.$visible"></i>\n</span>\n')}]),angular.module("angularCmsBlox").config(function(a){a.google({clientId:"402827681397-4bud9sjicgcshr9i5d6b1u9rmqccp3km.apps.googleusercontent.com",url:"http://localhost:3000/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",requiredUrlParams:["scope"],optionalUrlParams:["display"],display:"popup",type:"2.0",popupOptions:{width:580,height:400}})}),angular.module("angularCmsBlox").factory("authService",["$resource",function(a){var b,c,d=a("/auth/me"),e=function(a,c){d.get(function(d){b=d,c(b.role>=a?!0:!1)})};return{isAuthorized:e,getPath:function(){return c},setPath:function(a){c=a}}}]),angular.module("angularCmsBlox").constant("ACCESS_LEVELS",{pub:1,user:2,aso:4,dooner:8,root:16}).config(function(a){var b=function(a,b){return{response:function(a){return a},responseError:function(c){switch(c.status){case 401:b.$broadcast("auth:loginRequired");break;case 403:b.$broadcast("auth:forbidden");break;case 404:b.$broadcast("page:notFound");break;case 500:b.$broadcast("server:error")}return a.reject(c)}}};a.interceptors.push(b)}).run(["$rootScope","$location","$auth","authService","ACCESS_LEVELS",function(a,b,c,d,e){a.$on("$stateChangeStart",function(a,f){f.accessLevel>e.pub&&(c.isAuthenticated()?d.isAuthorized(f.accessLevel,function(a){a||b.path("/")}):(d.setPath(b.path()),b.path("/login")))}),a.$on("auth:loginRequired",function(){d.setPath(b.path()),b.path("/login")})}]),angular.module("angularCmsBlox").directive("authLogin",["$location","authService",function(a,b){return{restrict:"EA",replace:!0,scope:{},templateUrl:"auth/login.template.html",controller:["$auth",function(c){this.authenticate=function(d){c.authenticate(d).then(function(){b.getPath()&&a.path(b.getPath())})},this.isAuthenticated=function(){return c.isAuthenticated()},this.login=function(){c.login({email:this.email,password:this.password})},this.logout=function(){c.logout()},this.login=function(){c.signup({email:this.email,password:this.password}).then(function(a){console.log(a.data)})}}],controllerAs:"ctrl",bindToController:!0}}]),angular.module("angularCmsBlox").directive("cmsText",[function(){return{restrict:"EA",replace:!1,scope:{key:"@cmsText"},templateUrl:"cms/cms-text.template.html",controller:"cmsTextController",controllerAs:"ctrl",bindToController:!0}}]).controller("cmsTextController",["$translate","$scope","$auth",function(a,b,c){a(this.key).then(function(a){b.text=a}),this.save=function(){},this.isAuthenticated=function(){return c.isAuthenticated()}}]),angular.module("angularCmsBlox").run(["editableOptions",function(a){a.theme="bs3"}]),angular.module("angularCmsBlox").factory("cmsService",["$resource","$q","cmsConfig",function(a,b,c){var d=a(c.url+"/:id",{id:"@id"}),e=function(a,c){var e=b.defer(),f=a+"."+c;return d.get({id:f},function(a){e.resolve(a)},function(a){e.reject(a.status)}),e.promise};return{getPageText:e,savePageText:function(){}}}]),angular.module("angularCmsBlox").provider("cmsConfig",["$translateProvider","$translatePartialLoaderProvider",function(a,b){this.setPreferredLanguage=function(b){this.preferredLanguage=b||"nl_NL",a.preferredLanguage(this.preferredLanguage)},this.setUrl=function(c){this.url=c||"/api/example/cms",a.useLoader("$translatePartialLoader",{urlTemplate:this.url+"/{part}.{lang}"}),b.addPart("home")},this.$get=function(){return this}}]);